<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>B1 Session 1: Routines & Habits</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',sans-serif;background:#5B5091;min-height:100vh;padding:20px}
.container{max-width:800px;margin:0 auto}
.header{background:#fff;border-radius:20px;padding:30px;margin-bottom:20px;text-align:center}
.header h1{color:#5B5091;font-size:1.4em}
.header p{color:#888}
.card{background:#fff;border-radius:16px;padding:25px;margin-bottom:20px}
.card h2{color:#5B5091;margin-bottom:15px}
label{font-weight:600;color:#333;display:block;margin-bottom:8px}
input[type="text"]{width:100%;padding:14px;border:2px solid #e0e0e0;border-radius:12px;font-size:16px;margin-bottom:15px}
.btn{background:#5B5091;color:#fff;border:none;padding:14px 32px;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;width:100%;margin-top:10px}
.btn:hover{background:#4a4080}
.btn-orange{background:#F5A623}
.btn-orange:hover{background:#e09000}
.btn-gray{background:#f5f5f5;color:#333}
.section{display:none}
.section.active{display:block}
.question{background:#f8f9fa;border-radius:12px;padding:20px;margin:15px 0;border:1px solid #eee}
.question h4{margin-bottom:15px;color:#333}
.option{padding:14px;border:2px solid #e0e0e0;border-radius:10px;cursor:pointer;margin-bottom:10px;display:flex;align-items:center;gap:12px}
.option:hover{border-color:#5B5091;background:#f8f6ff}
.option.selected{border-color:#5B5091;background:#f0edff}
.option.correct{border-color:#22c55e;background:#f0fdf4}
.option.incorrect{border-color:#ef4444;background:#fef2f2}
.circle{width:20px;height:20px;border:2px solid #ccc;border-radius:50%;flex-shrink:0}
.option.selected .circle{border-color:#5B5091;background:#5B5091}
textarea{width:100%;min-height:120px;padding:14px;border:2px solid #e0e0e0;border-radius:12px;font-size:16px;font-family:inherit;resize:vertical}
textarea:focus{outline:none;border-color:#5B5091}
.progress{height:8px;background:#e0e0e0;border-radius:4px;margin-bottom:20px}
.progress-bar{height:100%;background:#F5A623;border-radius:4px;transition:width 0.3s}
.score-card{background:linear-gradient(135deg,#5B5091,#7B6DB5);border-radius:20px;padding:35px;color:#fff;text-align:center}
.score-big{font-size:4em;font-weight:700}
.scores{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;margin-top:20px}
.scores>div{background:rgba(255,255,255,.15);border-radius:12px;padding:12px}
.scores label{font-size:.75em;opacity:.9}
.scores span{font-size:1.4em;font-weight:700;display:block}
.nav{display:flex;justify-content:space-between;margin-top:20px}
.record-btn{width:80px;height:80px;border-radius:50%;background:#fff;border:3px solid #5B5091;cursor:pointer;margin:20px auto;display:flex;align-items:center;justify-content:center}
.record-btn.recording{border-color:#ef4444;animation:pulse 1.5s infinite}
.record-dot{width:24px;height:24px;background:#5B5091;border-radius:50%}
.record-btn.recording .record-dot{background:#ef4444;border-radius:4px;width:20px;height:20px}
@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(239,68,68,.4)}50%{box-shadow:0 0 0 15px rgba(239,68,68,0)}}
.timer{text-align:center;font-size:28px;font-weight:700;color:#5B5091}
.status{text-align:center;color:#666;margin-top:10px}
audio{width:100%;margin-top:15px}
.hidden{display:none}
.feedback{background:#f8f6ff;border:1px solid #5B5091;border-radius:12px;padding:20px;margin-top:15px}
.word-bank{display:flex;flex-wrap:wrap;gap:10px;padding:15px;background:#f5f5f5;border-radius:12px;margin-bottom:15px}
.word{background:#fff;padding:10px 16px;border-radius:8px;cursor:grab;border:2px solid #e0e0e0}
.word:hover{border-color:#5B5091}
.drop-row{display:flex;gap:15px;align-items:center;margin-bottom:12px}
.drop-def{flex:1;background:#f8f9fa;padding:14px;border-radius:8px}
.drop-target{min-width:100px;min-height:44px;border:2px dashed #ccc;border-radius:8px;padding:10px;text-align:center}
.drop-target.filled{border-style:solid;border-color:#5B5091;background:#f8f6ff}
@media(max-width:600px){.scores{grid-template-columns:repeat(3,1fr)}}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>Session 1: Routines & Habits</h1>
<p>Week 1 • Present Simple & Adverbs of Frequency</p>
</div>

<div class="section active" id="start">
<div class="card">
<label>Your Full Name</label>
<input type="text" id="studentName" placeholder="Enter your name...">
<button class="btn" onclick="startQuiz()">Start Homework →</button>
</div>
</div>

<div class="section" id="s1">
<div class="card">
<div class="progress"><div class="progress-bar" style="width:20%"></div></div>
<h2>1. Listening</h2>
<p style="color:#666;margin-bottom:15px">Maria describes her daily routine</p>
<button class="btn btn-gray" onclick="document.getElementById('transcript').classList.toggle('hidden')">Show/Hide Transcript</button>
<div id="transcript" class="hidden" style="background:#f8f9fa;border-radius:12px;padding:20px;margin-top:15px">
<p><b>Maria:</b> I usually wake up at 6 AM. I always make my bed first thing in the morning.</p>
<p style="margin-top:10px"><b>Maria:</b> Then I have breakfast. I usually eat eggs and toast. I never skip breakfast.</p>
<p style="margin-top:10px"><b>Maria:</b> I often go to the gym before work. I exercise three times a week.</p>
<p style="margin-top:10px"><b>Maria:</b> After work, I sometimes cook dinner, but I occasionally order food.</p>
</div>
<div class="question"><h4>1. What time does Maria usually wake up?</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>6 AM</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>7 AM</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>8 AM</div>
</div>
<div class="question"><h4>2. What does Maria always do first?</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>Eat breakfast</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>Make her bed</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>Go to the gym</div>
</div>
<div class="question"><h4>3. How often does Maria exercise?</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>Every day</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>Once a week</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>Three times a week</div>
</div>
<button class="btn" onclick="checkS1()">Continue →</button>
</div>
</div>

<div class="section" id="s2">
<div class="card">
<div class="progress"><div class="progress-bar" style="width:40%"></div></div>
<h2>2. Vocabulary</h2>
<p style="color:#666;margin-bottom:15px">Match adverbs to their meanings (click word, then click target)</p>
<div class="word-bank" id="wordBank">
<div class="word" onclick="pickWord(this)">always</div>
<div class="word" onclick="pickWord(this)">usually</div>
<div class="word" onclick="pickWord(this)">often</div>
<div class="word" onclick="pickWord(this)">sometimes</div>
<div class="word" onclick="pickWord(this)">rarely</div>
<div class="word" onclick="pickWord(this)">never</div>
</div>
<div class="drop-row"><div class="drop-def">100% of the time</div><div class="drop-target" data-a="always" onclick="dropWord(this)"></div></div>
<div class="drop-row"><div class="drop-def">About 80%</div><div class="drop-target" data-a="usually" onclick="dropWord(this)"></div></div>
<div class="drop-row"><div class="drop-def">About 60%</div><div class="drop-target" data-a="often" onclick="dropWord(this)"></div></div>
<div class="drop-row"><div class="drop-def">About 50%</div><div class="drop-target" data-a="sometimes" onclick="dropWord(this)"></div></div>
<div class="drop-row"><div class="drop-def">About 10%</div><div class="drop-target" data-a="rarely" onclick="dropWord(this)"></div></div>
<div class="drop-row"><div class="drop-def">0% of the time</div><div class="drop-target" data-a="never" onclick="dropWord(this)"></div></div>
<button class="btn" onclick="checkS2()">Continue →</button>
</div>
</div>

<div class="section" id="s3">
<div class="card">
<div class="progress"><div class="progress-bar" style="width:60%"></div></div>
<h2>3. Writing</h2>
<p style="color:#666;margin-bottom:15px">Write 6-8 sentences about your daily routine using adverbs of frequency.</p>
<textarea id="writing" placeholder="I usually wake up at..."></textarea>
<p style="text-align:right;color:#888;margin-top:5px">Words: <span id="wc">0</span></p>
<div id="wFeedback" class="feedback hidden"></div>
<button class="btn" id="wBtn" onclick="checkWriting()">Get Feedback →</button>
<button class="btn hidden" id="wNext" onclick="showSection('s4')">Continue →</button>
</div>
</div>

<div class="section" id="s4">
<div class="card">
<div class="progress"><div class="progress-bar" style="width:80%"></div></div>
<h2>4. Speaking</h2>
<p style="color:#666;margin-bottom:15px">Describe your morning routine (30-60 seconds)</p>
<div class="record-btn" id="recBtn" onclick="toggleRec()"><div class="record-dot"></div></div>
<div class="timer" id="timer">0:00</div>
<div class="status" id="recStatus">Click to start recording</div>
<audio id="audio" controls class="hidden"></audio>
<div id="sFeedback" class="feedback hidden"></div>
<button class="btn" id="sBtn" onclick="checkSpeaking()" disabled>Continue →</button>
</div>
</div>

<div class="section" id="s5">
<div class="card">
<div class="progress"><div class="progress-bar" style="width:100%"></div></div>
<h2>5. Grammar Quiz</h2>
<div class="question" data-c="b"><h4>1. She _____ to work by bus.</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>go</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>goes</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>going</div>
</div>
<div class="question" data-c="c"><h4>2. I _____ eat fast food. (0%)</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>always</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>sometimes</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>never</div>
</div>
<div class="question" data-c="b"><h4>3. Where does the adverb go? "He is late."</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>Always he is late</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>He is always late</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>He always is late</div>
</div>
<div class="question" data-c="b"><h4>4. They _____ (not work) on weekends.</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>doesn't work</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>don't work</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>not work</div>
</div>
<div class="question" data-c="a"><h4>5. _____ she drink coffee?</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>Does</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>Do</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>Is</div>
</div>
<div class="question" data-c="b"><h4>6. He _____ wakes up early. (80%)</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>never</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>usually</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>rarely</div>
</div>
<div class="question" data-c="a"><h4>7. My parents _____ TV in the evening.</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>watch</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>watches</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>watching</div>
</div>
<div class="question" data-c="b"><h4>8. I _____ go to the gym. (50%)</h4>
<div class="option" onclick="sel(this)" data-v="a"><div class="circle"></div>always</div>
<div class="option" onclick="sel(this)" data-v="b"><div class="circle"></div>sometimes</div>
<div class="option" onclick="sel(this)" data-v="c"><div class="circle"></div>never</div>
</div>
<button class="btn btn-orange" onclick="submitFinal()">Submit Homework ✓</button>
</div>
</div>

<div class="section" id="results">
<div class="score-card">
<p style="opacity:.8">Session 1 Complete!</p>
<div class="score-big" id="finalPct">0%</div>
<p id="studentDisplay"></p>
<div class="scores">
<div><label>Listening</label><span id="scL">0/3</span></div>
<div><label>Vocab</label><span id="scV">0/6</span></div>
<div><label>Writing</label><span id="scW">0/20</span></div>
<div><label>Speaking</label><span id="scS">0/20</span></div>
<div><label>Grammar</label><span id="scG">0/8</span></div>
</div>
<button class="btn btn-orange" style="margin-top:25px" onclick="submitToTeacher()">Submit to Teacher →</button>
</div>
<div style="text-align:center;margin-top:20px">
<button class="btn btn-gray" onclick="location.reload()">Try Again</button>
</div>
</div>

</div>
<script>
const SESSION='1';
let name='',scores={l:0,v:0,w:0,s:0,g:0};
let selectedWord=null,isRec=false,mediaRec=null,chunks=[],recTime=0,recTimer=null;

function startQuiz(){
  name=document.getElementById('studentName').value.trim();
  if(!name){alert('Please enter your name');return;}
  showSection('s1');
}

function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.scrollTo(0,0);
}

function sel(el){
  el.parentElement.querySelectorAll('.option').forEach(o=>o.classList.remove('selected'));
  el.classList.add('selected');
}

function checkS1(){
  const answers=['a','b','c'];
  let correct=0;
  document.querySelectorAll('#s1 .question').forEach((q,i)=>{
    const selected=q.querySelector('.option.selected');
    if(selected && selected.dataset.v===answers[i])correct++;
  });
  scores.l=correct;
  showSection('s2');
}

function pickWord(el){
  document.querySelectorAll('.word').forEach(w=>w.style.background='#fff');
  el.style.background='#f0edff';
  selectedWord=el.textContent;
}

function dropWord(target){
  if(!selectedWord)return;
  target.textContent=selectedWord;
  target.classList.add('filled');
  const wordEl=Array.from(document.querySelectorAll('.word')).find(w=>w.textContent===selectedWord);
  if(wordEl)wordEl.style.display='none';
  selectedWord=null;
}

function checkS2(){
  let correct=0;
  document.querySelectorAll('.drop-target').forEach(t=>{
    if(t.textContent===t.dataset.a)correct++;
  });
  scores.v=correct;
  showSection('s3');
}

document.getElementById('writing').addEventListener('input',function(){
  const words=this.value.trim().split(/\s+/).filter(w=>w).length;
  document.getElementById('wc').textContent=words;
});

function checkWriting(){
  const text=document.getElementById('writing').value.toLowerCase();
  const adverbs=['always','usually','often','sometimes','rarely','never'].filter(a=>text.includes(a)).length;
  const verbs=['wake','eat','go','work','have','make','get'].filter(v=>text.includes(v)).length;
  scores.w=Math.min(20,adverbs*3+verbs*2);
  document.getElementById('wFeedback').innerHTML='<b>Feedback:</b> Found '+adverbs+' adverbs, '+verbs+' routine verbs. Score: '+scores.w+'/20';
  document.getElementById('wFeedback').classList.remove('hidden');
  document.getElementById('wBtn').classList.add('hidden');
  document.getElementById('wNext').classList.remove('hidden');
}

async function toggleRec(){
  if(!isRec){
    try{
      const stream=await navigator.mediaDevices.getUserMedia({audio:true});
      mediaRec=new MediaRecorder(stream);
      chunks=[];
      mediaRec.ondataavailable=e=>chunks.push(e.data);
      mediaRec.onstop=()=>{
        const blob=new Blob(chunks,{type:'audio/webm'});
        document.getElementById('audio').src=URL.createObjectURL(blob);
        document.getElementById('audio').classList.remove('hidden');
        document.getElementById('sBtn').disabled=false;
      };
      mediaRec.start();
      isRec=true;
      recTime=0;
      document.getElementById('recBtn').classList.add('recording');
      document.getElementById('recStatus').textContent='Recording...';
      recTimer=setInterval(()=>{
        recTime++;
        document.getElementById('timer').textContent=Math.floor(recTime/60)+':'+(recTime%60).toString().padStart(2,'0');
      },1000);
    }catch(e){alert('Microphone error: '+e.message);}
  }else{
    mediaRec.stop();
    mediaRec.stream.getTracks().forEach(t=>t.stop());
    clearInterval(recTimer);
    isRec=false;
    document.getElementById('recBtn').classList.remove('recording');
    document.getElementById('recStatus').textContent='Recording saved!';
  }
}

function checkSpeaking(){
  scores.s=recTime>=30?20:recTime>=20?15:recTime>=10?10:5;
  document.getElementById('sFeedback').innerHTML='<b>Feedback:</b> Duration '+Math.floor(recTime/60)+':'+(recTime%60).toString().padStart(2,'0')+'. Score: '+scores.s+'/20';
  document.getElementById('sFeedback').classList.remove('hidden');
  showSection('s5');
}

function submitFinal(){
  let correct=0;
  document.querySelectorAll('#s5 .question').forEach(q=>{
    const sel=q.querySelector('.option.selected');
    const ans=q.dataset.c;
    if(sel){
      if(sel.dataset.v===ans){correct++;sel.classList.add('correct');}
      else{sel.classList.add('incorrect');q.querySelector('[data-v="'+ans+'"]').classList.add('correct');}
    }
  });
  scores.g=correct;
  const total=scores.l+scores.v+scores.w+scores.s+scores.g;
  const pct=Math.round(total/57*100);
  document.getElementById('finalPct').textContent=pct+'%';
  document.getElementById('studentDisplay').textContent=name;
  document.getElementById('scL').textContent=scores.l+'/3';
  document.getElementById('scV').textContent=scores.v+'/6';
  document.getElementById('scW').textContent=scores.w+'/20';
  document.getElementById('scS').textContent=scores.s+'/20';
  document.getElementById('scG').textContent=scores.g+'/8';
  showSection('results');
}

function submitToTeacher(){
  const pct=Math.round((scores.l+scores.v+scores.w+scores.s+scores.g)/57*100);
  const url='https://docs.google.com/forms/d/e/1FAIpQLSf9uEs5MqWLveyoaMBxeWx3pW1b90siwgaom766CpwqnOI7Dg/viewform?usp=pp_url'+
    '&entry.518151516='+encodeURIComponent(name)+
    '&entry.864654596='+encodeURIComponent(SESSION)+
    '&entry.258952242='+encodeURIComponent(scores.l+'/3')+
    '&entry.859150584='+encodeURIComponent(scores.v+'/6')+
    '&entry.1121796741='+encodeURIComponent(scores.w+'/20')+
    '&entry.1435469716='+encodeURIComponent(scores.s+'/20')+
    '&entry.1998281944='+encodeURIComponent(scores.g+'/8')+
    '&entry.1207114914='+encodeURIComponent(pct+'%');
  window.open(url,'_blank');
}
</script>
</body>
</html>
